@model CardCollection

@{
    int count = 0;
}

<button id="add-file-btn" type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#myModal">Add File</button>

<div id="file-nav">

    @foreach (var file in Model.CardFiles)
    {
        var tabClass = "";
        switch (count % 3)
        {
            case 0:
                tabClass = "tab-one";
                break;
            case 1:
                tabClass = "tab-two";
                break;
            case 2:
                tabClass = "tab-three";
                break;
        }
        count++;
        <div class="file-tab @tabClass" data-file-id="@file.Id">
            <div class="tab-text" title="@file.Label">@file.Label</div>
        </div>
    }

</div>


<!-- The Modal -->
<div class="modal fade bg-dark text-light" id="myModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content bg-dark text-light">
            <div class="modal-header">
                <h5 class="modal-title">Create a new file</h5>
                <button type="button" class="btn-close text-light" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="create-file-form" action="@Url.Action("CreateFile", "CardCollection")" method="post">
                    <div class="form-group">
                        <label for="file-name" class="col-form-label">Name your file:</label>
                        <input type="text" class="form-control bg-dark text-light" id="file-name" name="name">
                    </div>
                    <input type="hidden" name="parentCollectionId" value="@Model.Id" />
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary text-light" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary text-light" form="create-file-form">Create</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#create-file-form").submit(function (event) {
            event.preventDefault(); // prevent form from submitting the traditional way

            $.ajax({
                type: "POST",
                url: "@Url.Action("CreateFile", "CardCollection")",
                data: $(this).serialize(),
                success: function () {
                    // Refresh the current page
                    location.reload();
                },
                error: function (error) {
                    console.error("An error occurred:", error);
                    // Handle error - maybe display a message to the user
                }
            });
        });
    });
</script>
